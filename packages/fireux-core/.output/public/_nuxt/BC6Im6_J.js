import{cG as h,cH as m,cI as v,cJ as f,e as U}from"./BVTICooV.js";function y(){const l=h();return{uploadFile:async(d,g)=>{try{const o=m(l,d);return await v(o,g),await f(o)}catch(o){return console.error("[Storage] Upload failed:",(o==null?void 0:o.message)||o),null}}}}function I(){const{uploadFile:l}=y(),p=h(),{appName:d}=U(),g=e=>fetch(e).then(t=>t.blob()),o=(e,t=800)=>new Promise((u,n)=>{const r=new Image;r.onload=()=>{const s=Math.min(1,t/r.width),a=document.createElement("canvas");a.width=r.width*s,a.height=r.height*s;const c=a.getContext("2d");if(!c){n(new Error("Canvas context not available"));return}c.drawImage(r,0,0,a.width,a.height),a.toBlob(i=>i?u(i):n(new Error("Resize failed")),"image/jpeg",.85)},r.onerror=()=>n(new Error("Failed to load image")),r.src=URL.createObjectURL(e)}),b=async(e,t)=>(await l(t,e),f(m(p,t))),w=async(e,t,u,n,r)=>{const s=typeof e=="string"?await g(e):e;let a=r;if(!a)switch(n){case"avatar":a=400;break;case"featured":case"social":a=1200;break;default:a=800}const c=await o(s,a),i=`${d}/${t}/${u}/${n}.jpg`;return b(c,i)};return{uploadImage:w,uploadUserAvatar:async(e,t)=>w(e,"users",t,"avatar",400)}}export{I as u};
